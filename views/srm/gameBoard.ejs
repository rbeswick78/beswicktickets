<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Steal Ryan's Money - Game Board</title>
  <!-- Google Fonts: Rye for headers, Roboto for UI -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@700&family=Roboto:wght@400;700&family=Rye&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/srm.css" />
</head>
<body
  data-game-id="<%= game._id %>"
  data-current-user-id="<%= currentUserId %>"
  data-dealer-id="<%= game.dealer._id.toString() %>"
>
  <!-- Toast Notification Container -->
  <div id="toast-container"></div>

  <div class="game-wrapper">
    <header class="game-header">
        <h1 class="srm-title">
            <span id="title-steal" class="title-word">Steal</span>
            <span id="title-ryans" class="title-word">Ryan's</span>
            <span id="title-money" class="title-word">Money</span>
        </h1>
    </header>

    <div id="card-container">
      <!-- Card 1 -->
      <div class="card-section">
        <div class="card-slot" id="card-slot-1">
          <div class="card-flip-container">
            <div class="card-inner">
              <div class="card-front">
                <img src="/svg/cards/2B.svg" alt="Card Back" />
              </div>
              <div class="card-back">
                <img src="" class="card-face-img" alt="Card Face" />
              </div>
            </div>
          </div>
        </div>
        <div class="betting-container" id="betting-container-1">
          <div class="suit-quad suit-diamond" data-spot-id="card1-suit-♦"></div>
          <div class="suit-quad suit-heart"   data-spot-id="card1-suit-♥"></div>
          <div class="suit-quad suit-spade"   data-spot-id="card1-suit-♠"></div>
          <div class="suit-quad suit-club"    data-spot-id="card1-suit-♣"></div>

          <div class="border-bet border-bet-diamond-heart" 
               data-spot-id="card1-suits-♦♥"
               title="Bet on Diamonds OR Hearts"></div>
          <div class="border-bet border-bet-diamond-spade" 
               data-spot-id="card1-suits-♦♠"
               title="Bet on Diamonds OR Spades"></div>
          <div class="border-bet border-bet-heart-club" 
               data-spot-id="card1-suits-♥♣"
               title="Bet on Hearts OR Clubs"></div>
          <div class="border-bet border-bet-spade-club" 
               data-spot-id="card1-suits-♠♣"
               title="Bet on Spades OR Clubs"></div>

          <div class="joker-bet" data-spot-id="card1-joker"></div>

          <div class="odd-even-bet odd-bet" data-spot-id="card1-odd" title="Bet on Odd">Odd</div>
          
          <div class="ace-bet" data-spot-id="card1-ace" title="Bet on Ace"></div>

          <div class="odd-even-bet even-bet" data-spot-id="card1-even" title="Bet on Even">Even</div>

          <div class="lowest-bet" data-spot-id="card1-low" title="Bet on Lowest card"></div>
          <div class="middle-bet" data-spot-id="card1-mid" title="Bet on Middle card"></div>
          <div class="highest-bet" data-spot-id="card1-high" title="Bet on Highest card"></div>
        </div>
      </div>

      <!-- Card 2 -->
      <div class="card-section">
        <div class="card-slot" id="card-slot-2">
            <div class="card-flip-container">
                <div class="card-inner">
                  <div class="card-front">
                    <img src="/svg/cards/2B.svg" alt="Card Back" />
                  </div>
                  <div class="card-back">
                    <img src="" class="card-face-img" alt="Card Face" />
                  </div>
                </div>
              </div>
        </div>
        <div class="betting-container" id="betting-container-2">
          <div class="suit-quad suit-diamond" data-spot-id="card2-suit-♦"></div>
          <div class="suit-quad suit-heart"   data-spot-id="card2-suit-♥"></div>
          <div class="suit-quad suit-spade"   data-spot-id="card2-suit-♠"></div>
          <div class="suit-quad suit-club"    data-spot-id="card2-suit-♣"></div>

          <div class="border-bet border-bet-diamond-heart" 
               data-spot-id="card2-suits-♦♥"
               title="Bet on Diamonds OR Hearts"></div>
          <div class="border-bet border-bet-diamond-spade" 
               data-spot-id="card2-suits-♦♠"
               title="Bet on Diamonds OR Spades"></div>
          <div class="border-bet border-bet-heart-club" 
               data-spot-id="card2-suits-♥♣"
               title="Bet on Hearts OR Clubs"></div>
          <div class="border-bet border-bet-spade-club" 
               data-spot-id="card2-suits-♠♣"
               title="Bet on Spades OR Clubs"></div>

          <div class="joker-bet" data-spot-id="card2-joker"></div>

          <div class="odd-even-bet odd-bet" data-spot-id="card2-odd" title="Bet on Odd">Odd</div>
          
          <div class="ace-bet" data-spot-id="card2-ace" title="Bet on Ace"></div>

          <div class="odd-even-bet even-bet" data-spot-id="card2-even" title="Bet on Even">Even</div>

          <div class="lowest-bet" data-spot-id="card2-low"    title="Bet on Lowest card"></div>
          <div class="middle-bet" data-spot-id="card2-mid"   title="Bet on Middle card"></div>
          <div class="highest-bet" data-spot-id="card2-high" title="Bet on Highest card"></div>
        </div>
      </div>

      <!-- Card 3 -->
      <div class="card-section">
        <div class="card-slot" id="card-slot-3">
            <div class="card-flip-container">
                <div class="card-inner">
                  <div class="card-front">
                    <img src="/svg/cards/2B.svg" alt="Card Back" />
                  </div>
                  <div class="card-back">
                    <img src="" class="card-face-img" alt="Card Face" />
                  </div>
                </div>
              </div>
        </div>
        <div class="betting-container" id="betting-container-3">
          <div class="suit-quad suit-diamond" data-spot-id="card3-suit-♦"></div>
          <div class="suit-quad suit-heart"   data-spot-id="card3-suit-♥"></div>
          <div class="suit-quad suit-spade"   data-spot-id="card3-suit-♠"></div>
          <div class="suit-quad suit-club"    data-spot-id="card3-suit-♣"></div>

          <div class="border-bet border-bet-diamond-heart" 
               data-spot-id="card3-suits-♦♥"
               title="Bet on Diamonds OR Hearts"></div>
          <div class="border-bet border-bet-diamond-spade" 
               data-spot-id="card3-suits-♦♠"
               title="Bet on Diamonds OR Spades"></div>
          <div class="border-bet border-bet-heart-club" 
               data-spot-id="card3-suits-♥♣"
               title="Bet on Hearts OR Clubs"></div>
          <div class="border-bet border-bet-spade-club" 
               data-spot-id="card3-suits-♠♣"
               title="Bet on Spades OR Clubs"></div>

          <div class="joker-bet" data-spot-id="card3-joker"></div>

          <div class="odd-even-bet odd-bet" data-spot-id="card3-odd" title="Bet on Odd">Odd</div>
          
          <div class="ace-bet" data-spot-id="card3-ace" title="Bet on Ace"></div>

          <div class="odd-even-bet even-bet" data-spot-id="card3-even" title="Bet on Even">Even</div>

          <div class="lowest-bet" data-spot-id="card3-low"    title="Bet on Lowest card"></div>
          <div class="middle-bet" data-spot-id="card3-mid"   title="Bet on Middle card"></div>
          <div class="highest-bet" data-spot-id="card3-high" title="Bet on Highest card"></div>
        </div>
      </div>
    </div>

    <!-- HUD / Sidebar Toggle -->
    <button id="hud-toggle" class="hud-toggle-btn" aria-label="Toggle Player Menu">
        ☰ Players
    </button>

    <!-- Sidebar / Drawer -->
    <div id="player-sidebar" class="player-sidebar">
        <div class="sidebar-header">
            <h3>Players</h3>
            <button id="hud-close" class="hud-close-btn">&times;</button>
        </div>
        <div id="balance-list" class="balance-list"></div>
    </div>
    
    <!-- Bottom UI Islands -->
    <div class="bottom-islands">
        <!-- Bank Island (Left) -->
        <div class="ui-island bank-island">
            <div class="balance-led">
                <span class="led-label">Bank</span>
                <span id="my-balance-amount" class="led-display">0</span>
            </div>
        </div>
        
        <!-- Chip Island (Center) -->
        <div class="ui-island chip-island">
            <div class="chip-selector">
                <div class="chip-option selected" data-value="1">1</div>
                <div class="chip-option" data-value="5">5</div>
                <div class="chip-option" data-value="10">10</div>
                <div class="chip-option" data-value="20">20</div>
                <div class="chip-option" data-value="50">50</div>
            </div>
        </div>
        
        <!-- Deal Island (Right) - Dealer only -->
        <% if (game.dealer._id.toString() === currentUserId) { %>
            <div class="ui-island deal-island">
                <button id="deal-button" class="dealer-button">Deal</button>
            </div>
        <% } %>
    </div>

  </div> <!-- end game-wrapper -->

  <!-- Round Results Modal -->
  <div id="payout-results" class="results-modal-overlay" style="display: none;">
    <div class="results-modal">
      <!-- Confetti container for winners -->
      <div class="confetti-container" id="confetti-container"></div>
      
      <!-- Header with dealt cards -->
      <div class="results-header">
        <h2 class="results-title">Round Results</h2>
        <div class="dealt-cards-display">
          <div class="dealt-card" id="result-card-1">
            <img src="" alt="Card 1" />
          </div>
          <div class="dealt-card" id="result-card-2">
            <img src="" alt="Card 2" />
          </div>
          <div class="dealt-card" id="result-card-3">
            <img src="" alt="Card 3" />
          </div>
        </div>
      </div>

      <!-- Player Standings Section -->
      <div class="player-standings-section">
        <h3 class="section-title">Player Standings</h3>
        <div class="player-standings-grid" id="player-standings-grid">
          <!-- Player cards will be dynamically inserted here -->
        </div>
      </div>

      <!-- Bottom Section: Your Bets + Round Stats -->
      <div class="results-bottom-section">
        <div class="your-bets-section">
          <h4 class="subsection-title">Your Bets</h4>
          <div class="your-bets-list" id="your-bets-list">
            <!-- Your individual bets listed here -->
          </div>
          <div class="your-net-result" id="your-net-result">
            Your Net: <span id="your-net-value">0</span>
          </div>
        </div>
        <div class="round-stats-section">
          <h4 class="subsection-title">Round Stats</h4>
          <div class="stat-row">
            <span class="stat-label">Total Pot:</span>
            <span class="stat-value" id="stat-total-pot">0</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Biggest Win:</span>
            <span class="stat-value win" id="stat-biggest-win">0</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Biggest Loss:</span>
            <span class="stat-value loss" id="stat-biggest-loss">0</span>
          </div>
        </div>
      </div>

      <!-- Close Button -->
      <button id="close-payout-results" class="close-results-btn">Continue</button>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script type="module" src="/js/srmGameBoard.js"></script>
</body>
</html>
